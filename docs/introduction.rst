.. contents:: :local:

Omówienie
=========

Projekt Pola składa się z kilku podprojektów, którego rdzeniem jest proejkt ``pola-backend`` i na nim się skupimy w tym dokumencie

.. image:: ./introduction.png

* `pola-backend <https://github.com/KlubJagiellonski/pola-backend>`__ - rdzeń aplikacji napisany w Django.
* `pola-ios <https://github.com/KlubJagiellonski/pola-ios>`__  - aplikacja na system iOS.
* `pola-android <https://github.com/KlubJagiellonski/pola-android>`__ - aplikacja na system Android.
* `pola-flutter <https://github.com/KlubJagiellonski/pola-flutter>`__ - aplikacja multiplatformowa napisana w Flutter (projekt niewydany).
* `pola-web <https://github.com/KlubJagiellonski/pola-web>`__ - statyczna strona napisana w Gatsby.
* `pola-bi <https://github.com/KlubJagiellonski/pola-backend/tree/master/pola-bi/>`__ - zbiór narzędzi odpowiedzialnych za analityke biznesową.

* `pola-ai <https://github.com/KlubJagiellonski/pola-ai>`__ - sztuczna inteligencja rozpoznajaca produkty (projekt porzucony).
* `pola-facebook <https://github.com/KlubJagiellonski/pola-facebook>`__ - chatbot na Facebook (projekt porzuczony).

Architektura
------------

.. image:: ./architecture.png

Założenia
---------

* ``pola-backend`` zapewnia dwie funkcjonalności:

  * API wykorzystywany jest przez ``pola-ios``, ``pola-android``, ``pola-flutter``, ``pola-web``.
  * CMS wykorzystywany jest przez redakcje do aktualizacji danych

* ``pola-backend`` jest uruchamiana na platformie ``Heroku``
  Platforma dostarcza kilka usług oodpowiedzialnych za monitoring:

  * `New Relic APM <https://elements.heroku.com/addons/newrelic>`__ - monitoring aplikacji (rzadko wykorzystywany)
  * `Logentries <https://elements.heroku.com/addons/logentries>`__ - dziennik aplikacji
  * `Sentry <https://elements.heroku.com/addons/sentry>`__ - monitoring błedów w aplikacji (często wykorzystywany)
  * `Heroku Scheduler <https://elements.heroku.com/addons/scheduler>`__ - uruchamianie operacji cyklicznych

  Ponad to dostarcza usługi składowania danych:

  * `Redis To Go <https://elements.heroku.com/addons/redistogo>`__ - cache
  * `Heroku Postgres <https://elements.heroku.com/addons/heroku-postgresql>`__ - baza danych

  Wykorzystywany jest również `MailGun <https://elements.heroku.com/addons/mailgun>`__ do wysyłania wiadomości z przypomniemiem hasła.

* ``pola-backend`` jest aplikacja kontenerową wdrażana przez process Ci/CD uruchamiany na Github Action. Po szczegóły, patrz: `Wdrożenie <./deploy.rst>`__

* ``pola-web`` jest rozwijana, jako niezależna aplikacja Gatsby/React, a następnie w procesie CI/CD uruchamianym na ``Github Action`` jest publikowana na wiaderku ``AWS Bucket Web``. ``pola-web`` odczytuje dane z wiaderka i zwraca użytkowniką. Z tego wynika, że ``pola-backend`` i ``pola-web`` mogą być wdrażane niezależnie, ale wykorzystują wspólne wiaderko.

* ``pola-backend`` wykorzystuje wiaderka na platformie AWS:

  * ``AWS Bucket AI Pics`` - przechowuje zdjęcia od użytkowników, które miały być wykorzystywane przez ``pola-ai`` (project porzucony).
  * ``AWS Bucket Backend`` - przechowuje pliki przesłane przez uzytkowników, które nie powinny być publiczne np. raporty.
  * ``AWS Bucket Public`` - przechowuje pliki statyczne np. kod CSS/JS,. Zawartość jest publiczna dla wszystkich.
  * ``AWS Bucket Web`` - przechowuje skompilowana aplikacje ``pola-web``.

* ``pola-bi`` jest składa się dwóch elementów:

  Kodu w tym repozytorium:

  * ``dbt``` - projet `dbt <https://docs.getdbt.com/docs/introduction>`__, który pozwala na wykonywanie transformacji danych.
  * ``postgres_to_gcs``- skryptu Python, który kopiuje dane z ``PostgresSQL`` do `Gogole BigQuery <https://cloud.google.com/bigquery>`__

  Obydwa narzędzia są uruchamiane na ``GitHub Action``.

  Do wizualizacji danych wykorzystywany jest `Google Looker Studio/Google Data Studio <https://lookerstudio.google.com/>`__. On łączy się z ``Google BigQuery``.
